<table class="departures">
	<tr class="day_name">
		<td class="hour">{$lang.timetable_hours}</td>
		{$i=0}
		{foreach $dayTypes as $dT}
			{if $minsCount[$i] != 0}
				<td class="day_name">
					{$dT[1]}
				</td>
			{/if}
			{$i=$i+1}
		{/foreach}
	</tr>
	
	{$h=0}
	{foreach $hours as $hour}
		<tr class="hour_row">
			<td class="hour">{$hour}</td>
			{$j=0}
			{foreach $mins as $min}
			{if $minsCount[$j] != 0}
				<td class="mins">
					{foreach $min[$h] as $m}
						{$cTime = $hour|cat:":"|cat:$m[0]}
						{*passed time thanks to: http://stackoverflow.com/questions/2832467/php-how-can-i-check-if-the-current-date-time-is-past-a-set-date-time*}
						{if $m[4]==2}
							{$status="starting"}
						{elseif $m[4]==1}
							{$status="ending"}
						{else}
							{$status=""}
						{/if}
						{if $wPrint==null}
							<span class="hour_block"><a{if $currTime > $cTime|strtotime} class="passed {$status}"{elseif $nextTimeHour > $cTime|strtotime} class="next {$status}"{else} class="{$status}"{/if} href="?line={$wLine}&amp;dir={$wDir}&amp;stop={$wStop}&amp;course={$m[2]}&amp;day={$m[3]}{call options}">{$m[0]}<sup>{$m[1]}</sup></a></span>
						{else}
							{if $status=="starting"}
								{$css = "color: green;"}
								{$color = "green"}
							{elseif $status=="ending"}
								{$css = "color: red;"}
								{$color = "red"}
							{else}
								{$css=""}
								{$color = "black"}
							{/if}
							<span class="hour_block" style="{$css}">{$m[0]}{$m[1]}</span>
						{/if}
					{/foreach}
				</td>
			{/if}
			{$j=$j+1}
		{/foreach}
		</tr>
		{$h=$h+1}
	{/foreach}	
</table>